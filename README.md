Папки проектов и порты такие же в тестовом окружении (можно посмотреть в конфигах в папке nginx). Нужен установленный докер.

## Запуск окружения:
- копируем папки проектов внутрь apps
- подкидываем свой бекап mysql в папку db-bak или пользуемся тем, который там уже лежит, но в нем только структура бд прода без данных
- собираем `docker-compose build`
- запускаем `docker-compose up -d` - можно запустить без ключа `-d`, тогда логи всех контейнеров будут падать в консоль
- разворачиваем бекап базы (в данном случае бекап со структурой бд прода) `docker exec -ti mysqldb bash` затем `/usr/bin/mysql -u root -pradiovolna < /backup/backup.sql` и ждем 5-10 мин, даем права пользователю neroot: `/usr/bin/mysql -u root -pradiovolna` там вводим `GRANT ALL PRIVILEGES ON *.* TO 'neroot';`
- в конфигах проектов адрес mysql сервера должен быть `mysqldb` (вместо localhost)
- для перезапуска контейнеров использовать `docker-compose restart`
- полная остановка, например для обновления контейнеров `docker-compose down`
- запуск с пересборкой и пересозданием всех контейнеров `docker-compose up -d --build --force-recreate` хорошо использовать в комбинации с предыдущей командой для полного обнуления окружения


## Основные команды докера:
Для любой команды можно почитать подсказки введя `docker Команда --help`
- `docker start\stop\restart\kill ИмяКонтейнера` - команды для работы с контейнерами
- `docker ps` - вывести список работающих контейнеров, если добавить ключ `-a`, то выведет список всех контейнеров, в том числе выключенных
- `docker logs ИмяКонтейнера` - посмотреть логи контейнера
- `docker exec -ti sh ИмяКонтейнера` - провалится внутрь контейнера (консоль) 
- `docker run -d ИмяОбраза` - запустить контейнер с выбранным образом, образы можно поискать на https://hub.docker.com/ или собрать самостоятельно из докерфайла
- `docker pull ИмяОбраза` - скачать свежую версию образа
- `docker rm ИмяКонтейнера` - удалить контейнер
- `docker build Путь-До-Вашего-ДокерФайла` - собрать образ из докерфайла, путь может быть относительным, то есть при выполнении из папки в которой лежит докерфайл путь будет `.`
- `docker image prune` - удаляет неиспользуемые образы, по умолчанию они копятся до бесконечности
- `docker system prune` - удаляет все неиспользуемые контейнеры, сети и volume'ы + очищает кеш


## Общая информация:
- внутри контейнера `php` установлен `composer`, чтобы собрать что-либо нужно зайти внутрь контейнера `docker exec -ti php bash`, перейти в нужную директорию `cd /var/www/apps/И-Так-Далее` и использовать `composer install`
- конфиги всех приложений лежат в отдельных папках, после изменения необходимо перезапускать контейнер
- из одного контейнера можно обращаться на другие по имени (`container_name` в файле `docker-compose.yml`), это предпочтительный способ обмена информацией между ними, т.к ip может поменяться после рестарта контейнера
- на порту `9999` крутится adminer
